# Introdução ao Penetration Testing

Pentest: Penetration Testing (teste de invasão/intrusão). Consiste em um teste de segurança em sistemas para identificar e explorar fraquezas e vulnerabilidades de segurança com objetivo de medir o grau de risco e impacto que essas fraquezas possam trazer a organização.

Pentester é o nome dado ao profissional que realiza o serviço de Pentest.

## Importância do Pentest
- Identificar superfície de ataque e medir o nível de exposição do ambiente da empresa
- Testar controles de implementações
- Ficar em conformidade com normas de segurança (exemplo: PCI-DSS)

## Os resultados permitem:
- Comprovar o impacto do risco
- Tomar melhores decisões e investir corretamente em segurança
- Melhorar os controles de mecanismos de defesa
- Se antecipar a ataques futuros

## Tipos de Testes de Segurança
- Pentest (Penetration Testing): Leva mais tempo comparado com um analisador de vulnerabilidades porém é mais preciso e eficaz. Permite uma visão real do risco e impacto para o negócio, possibilitando encontrar vulnerabilidades não conhecidas.
- Análise de Vulnerabilidade: Ferramentas que contém uma base de vulnerabilidades catalogadas, permitindo assim ter maior visão e controle dos serviços  e aplicações com suas respectivas vulnerabilidades (Nessus, Openvas). Também permite automatizar os processos de scan, melhorando e agilizando o processo de detecção das vulnerabilidades.
- Red Team: Tem uma abordagem mais ampla que um Pentest, normalmente tem um objetivo específico e bem definido (Ex: Conseguir acesso as contas dos diretores da empresa, conseguir acesso ao servidor principal da rede interna) e normalmente não exige regras e limitações de uso de Engenharia Social, ataques físicos, tempo, etc. Também permite testar o time de resposta a incidentes (Blue Team).

## Modalidades de Pentest
- Blackbox: Não é fornecido nenhuma informação em relação ao ambiente que será testado. O Pentester terá que detectar as possíveis vulnerabilidades sem qualquer recebimento de informação por parte do contratante (testes às cegas).
- Graybox: É fornecida algumas informações que permitem que o Pentester possa detectar as vulnerabilidades.
- Whitebox: Todas as informações necessárias serão apresentadas pelo contratante ao Pentester.

## Tipos de Pentest
- Pentest Web
- Pentest Mobile
- Pentest Rede
- Pentest Wireless
- Pentest Físico
- Engenharia Social
- Testes de Stress (DDoS)
- Pentest Externo (Realizado à partida da internet)
- Pentest Interno (Realizado dentro de um ambiente privado)

## Metodologias de Pentest
- PTES - http://www.pentest-standard.org/index.php/Main_Page
- OWASP - https://www.owasp.org/index.php/Main_Page
- NIST - https://csrc.nist.gov/publications/detail/sp/800-115/final
- OSSTMM - https://www.isecom.org/mirror/OSSTMM.3.pdf

## Fases do PTES
1. Preparação para Ação
2. Coletar Informações
3. Varrer e Enumerar
4. Identificar Vulnerabilidades
5. Exploração
6. Aprofundar (Pós Exploração)
7. Documentar (Relatório)

## Metodologias Próprias
DNGP - Desec Nest Generation Pentesting
1. Pentest Identifica: Identifica riscos e impacto (prioriza criticidade) / Valida controles de segurança (permitindo otimizar)
2. Correção Baseada no Resultado do Pentest: Corrige as vulnerabilidades de acordo com o Pentest
3. Pentest  Valida a Correção: Re-Test (valida a correção)

1. Mapeamento: Mapear superfície, Reconhecer ambiente e análise do ambiente
2. Análise de Segurança: Análise de Vulnerabilidades, validação e exploração e coleta de evidências
3. Mitigação: DNPG report e Re-Test

Preparando para Ação
Objetivo: Entender de forma clara as necessidades do cliente

## O que o cliente espera do Pentest?
Exemplo de perguntas para o cliente:
1. É o primeiro teste?
2. É para cumprir alguma compliance? (ex: PCI-DSS)
3. O que considera valioso? Quais as preocupações?
4. Existe algum sistema frágil?
5. Qual o objetivo do Pentest?
6. O que você considera sucesso no projeto?
7. Existe alguma limitação?

Após entender as necessidades do cliente precisamos definir o escopo e o tipo de teste escolhido.
Exemplos:
- Tipo de Teste: Pentest Black Box Externo (abordagem ampla)
- Tipo de Teste: Pentest Web Gray Box (abordagem específica)

Definir URL/IP
- O que será testado?
- O que não será testado?

## Existe alguma limitação no espoco?
- Ataques de Stress (DDoS) não são permitidos
- Ataques de Engenharia social não são permitidos
- Não atacar o serviço "XPTO"

## Defina a data de início dos testes e o horário permitido
Exemplos:
- Executar apenas em horário comercial (09:00h às 18:00h)
- Não existe limites de horário

## Defina as responsabilidades
Exemplo:

Cabe a Desec apenas o levantamento, análise/exploração e elaboração dos relatórios relativos aos testes de invasão; correções, ajustes, atualizações não fazem parte do escopo desta atividade.

Autorização: No contrato tenha uma cláusula onde o cliente autoriza a execução do serviço e concorda com os testes. Nunca inicie um Pentest antes de ter o documento assinado pelo cliente autorizando o Pentest.

NDA - Acordo de Confidencialidade: O NDA funciona como um meio de segurança administrativo onde você garante que não vai expor os dados obtidos com o Pentest. Geralmente o descumprimento do NDA acarreta em processos judiciais juntamente com multas.

## Defina os termos de pagamento, como deverá ser pago e quando
Exemplo: O cliente irá pagar 30% do valor na assinatura do contrato e os 70% restante na entrega dos relatórios.

## Precificação
Formas de cobrar:
- Valor Hora (Defina um valor X para a hora técnica) e calcule o tempo estimado de execução. Ex: Pentest de 80 horas | Valor R$ 280,00 * 80h = R$ 22.400,00
- Valor Fixo (Defina um valor fixo para o serviço). Ex: Pentest Black Box = R$ 17.000,00

*Obs.: Tudo é relativo ao tipo de teste, complexidade, mercado, região, etc.*

